<UserControl x:Class="ElectronicShop.Accounting.Desktop.Views.ReportsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    </UserControl.Resources>
    <ScrollViewer VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled"
                  Padding="6">
        <StackPanel>
            <TextBlock Style="{StaticResource PageTitleStyle}"
                       Text="Reports" />
            <TextBlock Margin="0,4,0,16"
                       Style="{StaticResource PageSubtitleStyle}"
                       Text="Generate and analyze business reports" />

            <WrapPanel Margin="0,0,0,14">
                <Button Content="Sales Report"
                        Command="{Binding SelectSalesReportCommand}">
                    <Button.Style>
                        <Style BasedOn="{StaticResource TabButtonStyle}" TargetType="Button">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SelectedTab}" Value="SalesReport">
                                    <Setter Property="Background" Value="#16191E" />
                                    <Setter Property="Foreground" Value="#FFFFFF" />
                                    <Setter Property="BorderThickness" Value="0" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <Button Content="Purchase Report"
                        Command="{Binding SelectPurchaseReportCommand}">
                    <Button.Style>
                        <Style BasedOn="{StaticResource TabButtonStyle}" TargetType="Button">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SelectedTab}" Value="PurchaseReport">
                                    <Setter Property="Background" Value="#16191E" />
                                    <Setter Property="Foreground" Value="#FFFFFF" />
                                    <Setter Property="BorderThickness" Value="0" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <Button Content="Stock Report"
                        Command="{Binding SelectStockReportCommand}">
                    <Button.Style>
                        <Style BasedOn="{StaticResource TabButtonStyle}" TargetType="Button">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SelectedTab}" Value="StockReport">
                                    <Setter Property="Background" Value="#16191E" />
                                    <Setter Property="Foreground" Value="#FFFFFF" />
                                    <Setter Property="BorderThickness" Value="0" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <Button Content="Customer Outstanding"
                        Command="{Binding SelectCustomerOutstandingCommand}">
                    <Button.Style>
                        <Style BasedOn="{StaticResource TabButtonStyle}" TargetType="Button">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SelectedTab}" Value="CustomerOutstanding">
                                    <Setter Property="Background" Value="#16191E" />
                                    <Setter Property="Foreground" Value="#FFFFFF" />
                                    <Setter Property="BorderThickness" Value="0" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <Button Content="Vendor Outstanding"
                        Command="{Binding SelectVendorOutstandingCommand}">
                    <Button.Style>
                        <Style BasedOn="{StaticResource TabButtonStyle}" TargetType="Button">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SelectedTab}" Value="VendorOutstanding">
                                    <Setter Property="Background" Value="#16191E" />
                                    <Setter Property="Foreground" Value="#FFFFFF" />
                                    <Setter Property="BorderThickness" Value="0" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <Button Content="Profit &amp; Loss"
                        Command="{Binding SelectProfitLossCommand}">
                    <Button.Style>
                        <Style BasedOn="{StaticResource TabButtonStyle}" TargetType="Button">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SelectedTab}" Value="ProfitAndLoss">
                                    <Setter Property="Background" Value="#16191E" />
                                    <Setter Property="Foreground" Value="#FFFFFF" />
                                    <Setter Property="BorderThickness" Value="0" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <Button Content="Balance Sheet"
                        Command="{Binding SelectBalanceSheetCommand}">
                    <Button.Style>
                        <Style BasedOn="{StaticResource TabButtonStyle}" TargetType="Button">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SelectedTab}" Value="BalanceSheet">
                                    <Setter Property="Background" Value="#16191E" />
                                    <Setter Property="Foreground" Value="#FFFFFF" />
                                    <Setter Property="BorderThickness" Value="0" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </WrapPanel>

            <Border Style="{StaticResource SurfaceCardStyle}">
                <StackPanel>
                    <DockPanel Margin="0,0,0,12">
                        <StackPanel DockPanel.Dock="Left">
                            <TextBlock FontSize="30"
                                       FontWeight="Bold"
                                       Text="{Binding CurrentReportTitle}" />
                            <TextBlock Foreground="#6C737E"
                                       Text="Detailed purchase analysis and trends" />
                        </StackPanel>
                        <StackPanel DockPanel.Dock="Right"
                                    Orientation="Horizontal">
                            <Button Style="{StaticResource OutlineButtonStyle}"
                                    Padding="12,8"
                                    Margin="0,0,8,0"
                                    Content="Today" />
                            <Button Style="{StaticResource OutlineButtonStyle}"
                                    Padding="12,8"
                                    Margin="0,0,8,0"
                                    Content="Export Excel" />
                            <Button Style="{StaticResource OutlineButtonStyle}"
                                    Padding="12,8"
                                    Content="Export PDF" />
                        </StackPanel>
                    </DockPanel>

                    <ItemsControl ItemsSource="{Binding MetricCards}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <UniformGrid Columns="4" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="0,0,10,12"
                                        Style="{StaticResource SurfaceCardStyle}"
                                        Background="{Binding AccentColor}">
                                    <StackPanel>
                                        <TextBlock FontSize="12"
                                                   Foreground="#5E6572"
                                                   FontWeight="SemiBold"
                                                   Text="{Binding Title}" />
                                        <TextBlock Margin="0,8,0,0"
                                                   FontSize="38"
                                                   FontWeight="Bold"
                                                   Text="{Binding DisplayValue}" />
                                        <TextBlock Margin="0,8,0,0"
                                                   Foreground="#3E7F47"
                                                   FontWeight="SemiBold"
                                                   Text="{Binding TrendText}" />
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <Border Visibility="{Binding IsSalesVisible, Converter={StaticResource BoolToVisibilityConverter}}">
                        <DataGrid Style="{StaticResource DataGridStyle}"
                                  IsReadOnly="True"
                                  ItemsSource="{Binding SalesRows}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Date" Binding="{Binding Date}" Width="1*" />
                                <DataGridTextColumn Header="Bill No" Binding="{Binding BillNo}" Width="1*" />
                                <DataGridTextColumn Header="Customer Name" Binding="{Binding CustomerName}" Width="1.2*" />
                                <DataGridTextColumn Header="Item Name" Binding="{Binding ItemName}" Width="1.2*" />
                                <DataGridTextColumn Header="Qty" Binding="{Binding Quantity}" Width="0.7*" />
                                <DataGridTextColumn Header="Rate" Binding="{Binding Rate, StringFormat={}{0:C0}}" Width="0.9*" />
                                <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat={}{0:C0}}" Width="0.9*" />
                                <DataGridTextColumn Header="Payment Status" Binding="{Binding PaymentStatus}" Width="1*" />
                                <DataGridTextColumn Header="Payment Mode" Binding="{Binding PaymentMode}" Width="1*" />
                                <DataGridTextColumn Header="Profit" Binding="{Binding Profit, StringFormat={}{0:C0}}" Width="0.9*" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <Border Visibility="{Binding IsPurchaseVisible, Converter={StaticResource BoolToVisibilityConverter}}">
                        <DataGrid Style="{StaticResource DataGridStyle}"
                                  IsReadOnly="True"
                                  ItemsSource="{Binding PurchaseRows}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Date" Binding="{Binding Date}" Width="1*" />
                                <DataGridTextColumn Header="Bill No" Binding="{Binding BillNo}" Width="1*" />
                                <DataGridTextColumn Header="Vendor Name" Binding="{Binding VendorName}" Width="1.2*" />
                                <DataGridTextColumn Header="Item Name" Binding="{Binding ItemName}" Width="1.2*" />
                                <DataGridTextColumn Header="Qty" Binding="{Binding Quantity}" Width="0.7*" />
                                <DataGridTextColumn Header="Purchase Price" Binding="{Binding PurchasePrice, StringFormat={}{0:C0}}" Width="1*" />
                                <DataGridTextColumn Header="Total Amount" Binding="{Binding TotalAmount, StringFormat={}{0:C0}}" Width="1*" />
                                <DataGridTextColumn Header="Payment Status" Binding="{Binding PaymentStatus}" Width="1*" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <Border Visibility="{Binding IsStockVisible, Converter={StaticResource BoolToVisibilityConverter}}">
                        <DataGrid Style="{StaticResource DataGridStyle}"
                                  IsReadOnly="True"
                                  ItemsSource="{Binding StockRows}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Item Name" Binding="{Binding ItemName}" Width="1.2*" />
                                <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="1*" />
                                <DataGridTextColumn Header="Opening Stock" Binding="{Binding OpeningStock}" Width="0.9*" />
                                <DataGridTextColumn Header="Purchase Qty" Binding="{Binding PurchaseQuantity}" Width="0.9*" />
                                <DataGridTextColumn Header="Sales Qty" Binding="{Binding SalesQuantity}" Width="0.9*" />
                                <DataGridTextColumn Header="Current Stock" Binding="{Binding CurrentStock}" Width="0.9*" />
                                <DataGridTextColumn Header="Purchase Value" Binding="{Binding PurchaseValue, StringFormat={}{0:C0}}" Width="1*" />
                                <DataGridTextColumn Header="Sales Value" Binding="{Binding SalesValue, StringFormat={}{0:C0}}" Width="1*" />
                                <DataGridTextColumn Header="Profit Margin" Binding="{Binding ProfitMargin, StringFormat={}{0:C0}}" Width="0.9*" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <Border Visibility="{Binding IsCustomerOutstandingVisible, Converter={StaticResource BoolToVisibilityConverter}}">
                        <DataGrid Style="{StaticResource DataGridStyle}"
                                  IsReadOnly="True"
                                  ItemsSource="{Binding CustomerOutstandingRows}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Customer Name" Binding="{Binding CustomerName}" Width="1.3*" />
                                <DataGridTextColumn Header="Invoice No" Binding="{Binding InvoiceNo}" Width="1*" />
                                <DataGridTextColumn Header="Invoice Date" Binding="{Binding InvoiceDate}" Width="1*" />
                                <DataGridTextColumn Header="Total Amount" Binding="{Binding TotalAmount, StringFormat={}{0:C0}}" Width="1*" />
                                <DataGridTextColumn Header="Paid Amount" Binding="{Binding PaidAmount, StringFormat={}{0:C0}}" Width="1*" />
                                <DataGridTextColumn Header="Balance" Binding="{Binding Balance, StringFormat={}{0:C0}}" Width="1*" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <Border Visibility="{Binding IsVendorOutstandingVisible, Converter={StaticResource BoolToVisibilityConverter}}">
                        <DataGrid Style="{StaticResource DataGridStyle}"
                                  IsReadOnly="True"
                                  ItemsSource="{Binding VendorOutstandingRows}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Vendor Name" Binding="{Binding VendorName}" Width="1.3*" />
                                <DataGridTextColumn Header="Bill No" Binding="{Binding BillNo}" Width="1*" />
                                <DataGridTextColumn Header="Bill Date" Binding="{Binding BillDate}" Width="1*" />
                                <DataGridTextColumn Header="Total Amount" Binding="{Binding TotalAmount, StringFormat={}{0:C0}}" Width="1*" />
                                <DataGridTextColumn Header="Paid Amount" Binding="{Binding PaidAmount, StringFormat={}{0:C0}}" Width="1*" />
                                <DataGridTextColumn Header="Balance" Binding="{Binding Balance, StringFormat={}{0:C0}}" Width="1*" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <Border Visibility="{Binding IsProfitLossVisible, Converter={StaticResource BoolToVisibilityConverter}}">
                        <DataGrid Style="{StaticResource DataGridStyle}"
                                  IsReadOnly="True"
                                  ItemsSource="{Binding ProfitLossRows}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="#" Binding="{Binding Number}" Width="0.5*" />
                                <DataGridTextColumn Header="Product" Binding="{Binding Product}" Width="1.3*" />
                                <DataGridTextColumn Header="Units Sold" Binding="{Binding UnitsSold}" Width="1*" />
                                <DataGridTextColumn Header="Cost Price" Binding="{Binding CostPrice, StringFormat={}{0:C0}}" Width="1*" />
                                <DataGridTextColumn Header="Sales Price" Binding="{Binding SalesPrice, StringFormat={}{0:C0}}" Width="1*" />
                                <DataGridTextColumn Header="Total Profit" Binding="{Binding TotalProfit, StringFormat={}{0:C0}}" Width="1*" />
                                <DataGridTextColumn Header="Margin %" Binding="{Binding MarginPercent, StringFormat={}{0}%}" Width="0.8*" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <Border Visibility="{Binding IsBalanceSheetVisible, Converter={StaticResource BoolToVisibilityConverter}}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <Border Grid.Column="0"
                                    Margin="0,0,8,0"
                                    Style="{StaticResource SurfaceCardStyle}">
                                <StackPanel>
                                    <TextBlock FontSize="26"
                                               FontWeight="Bold"
                                               Text="Assets" />
                                    <DataGrid Style="{StaticResource DataGridStyle}"
                                              IsReadOnly="True"
                                              ItemsSource="{Binding AssetEntries}">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Account Details" Binding="{Binding AccountName}" Width="1.6*" />
                                            <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat={}{0:C0}}" Width="1*" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <TextBlock Margin="0,8,0,0"
                                               FontWeight="Bold"
                                               FontSize="20"
                                               Foreground="#269B6F"
                                               Text="{Binding BalanceSheetTotals.TotalAssets, StringFormat={}Total Assets: {0:C0}}" />
                                </StackPanel>
                            </Border>

                            <Border Grid.Column="1"
                                    Margin="8,0,0,0"
                                    Style="{StaticResource SurfaceCardStyle}">
                                <StackPanel>
                                    <TextBlock FontSize="26"
                                               FontWeight="Bold"
                                               Text="Liabilities &amp; Equity" />
                                    <DataGrid Style="{StaticResource DataGridStyle}"
                                              IsReadOnly="True"
                                              ItemsSource="{Binding LiabilityEntries}">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Account Details" Binding="{Binding AccountName}" Width="1.6*" />
                                            <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat={}{0:C0}}" Width="1*" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <TextBlock Margin="0,8,0,0"
                                               FontWeight="Bold"
                                               FontSize="20"
                                               Foreground="#4F72C8"
                                               Text="{Binding BalanceSheetTotals.TotalLiabilitiesAndEquity, StringFormat={}Total Liabilities + Equity: {0:C0}}" />
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
